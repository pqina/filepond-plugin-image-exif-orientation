/*
 * FilePondPluginImageExifOrientation 1.0.1
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.FilePondPluginImageExifOrientation=e()}(this,function(){"use strict";var n=function(n){return/^image\/jpeg/.test(n.type)},e={JPEG:65496,APP1:65505,EXIF:1165519206,TIFF:18761,Orientation:274,Unknown:65280},t=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n.getUint16(e,t)},i=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n.getUint32(e,t)},r=function(n){return new Promise(function(r,o){var a=new FileReader;a.onload=function(n){var o=new DataView(n.target.result);if(t(o,0)!==e.JPEG)return void r(-1);for(var a=o.byteLength,u=2;u<a;){var f=t(o,u);if(u+=2,f===e.APP1){if(i(o,u+=2)!==e.EXIF)break;var d=t(o,u+=6)===e.TIFF;u+=i(o,u+4,d);var v=t(o,u,d);u+=2;for(var l=0;l<v;l++)if(t(o,u+12*l,d)===e.Orientation)return void r(t(o,u+12*l+8,d))}else{if((f&e.Unknown)!==e.Unknown)break;u+=t(o,u)}}r(-1)},a.readAsArrayBuffer(n.slice(0,65536))})},o=function(e){var t=e.addFilter,i=e.utils,o=i.Type;return t("DID_LOAD_ITEM",function(e,t){var i=t.query;return new Promise(function(t,o){var a=e.file;return n(a)&&i("GET_ALLOW_IMAGE_EXIF_ORIENTATION")?void r(a).then(function(n){e.setMetadata("exif",{orientation:n}),t(e)}):t(e)})}),{options:{allowImageExifOrientation:[!0,o.BOOLEAN]}}};return"undefined"!=typeof navigator&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:o})),o});