/*
 * FilePondPluginImageExifOrientation 1.0.0
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */
const isJPEG=e=>/^image\/jpeg/.test(e.type),Marker={JPEG:65496,APP1:65505,EXIF:1165519206,TIFF:18761,Orientation:274,Unknown:65280},getUint16=(e,t,n=!1)=>e.getUint16(t,n),getUint32=(e,t,n=!1)=>e.getUint32(t,n),getImageOrientation=e=>new Promise((t,n)=>{const i=new FileReader;i.onload=function(e){const n=new DataView(e.target.result);if(getUint16(n,0)!==Marker.JPEG)return void t(-1);const i=n.byteLength;let r=2;for(;r<i;){const e=getUint16(n,r);if(r+=2,e===Marker.APP1){if(getUint32(n,r+=2)!==Marker.EXIF)break;const e=getUint16(n,r+=6)===Marker.TIFF;r+=getUint32(n,r+4,e);const i=getUint16(n,r,e);r+=2;for(let a=0;a<i;a++)if(getUint16(n,r+12*a,e)===Marker.Orientation)return void t(getUint16(n,r+12*a+8,e))}else{if((e&Marker.Unknown)!==Marker.Unknown)break;r+=getUint16(n,r)}}t(-1)},i.readAsArrayBuffer(e.slice(0,65536))});var plugin$1=e=>{const{addFilter:t,utils:n}=e,{Type:i}=n;return t("DID_LOAD_ITEM",(e,{query:t})=>new Promise((n,i)=>{const r=e.file;if(!isJPEG(r)||!t("GET_ALLOW_IMAGE_EXIF_ORIENTATION"))return n(e);getImageOrientation(r).then(t=>{e.setMetadata("exif",{orientation:t}),n(e)})})),{options:{allowImageExifOrientation:[!0,i.BOOLEAN]}}};document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin$1}));export default plugin$1;